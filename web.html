<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title> 3D modeling View</title>
  </head>
  <body>
    <ul id="fileList"></ul>
    <script>
      const fileListElement = document.getElementById('fileList');
      let selectedFile = '';
      function getFileList() {
        fetch('http://서버ip주소/files')
          .then(response => response.json())
          .then(data => {
            fileListElement.innerHTML = ''; // 기존의 파일 리스트를 지웁니다.
            for (let i = 0; i < data.length; i++) {
              if (data[i].endsWith('.obj')) { // ".obj" 파일만 라디오 버튼으로 생성합니다.
                const fileListItem = document.createElement('li');
                const radioButton = document.createElement('input');
                radioButton.type = 'radio';
                radioButton.name = 'file';
                radioButton.value = data[i];
                radioButton.addEventListener('change', (event) => {
                  selectedFile = event.target.value;
                });
                if (data[i] === selectedFile) {
                  radioButton.checked = true;
                }
                fileListItem.appendChild(radioButton);
                fileListItem.appendChild(document.createTextNode(data[i]));
                fileListElement.appendChild(fileListItem);
              }
            }
        })
        .catch(error => console.error(error));
      }
        const submitButton = document.createElement('button');
        submitButton.textContent = '선택';
        submitButton.addEventListener('click', () => {
        const selectedFile = document.querySelector('input[name="file"]:checked');
        if (selectedFile) {
          const fileName = selectedFile.value;
          const windowFeatures = 'height=400,width=400';
          const jsWindow = window.open('load_obj.html', '', windowFeatures);
          jsWindow.addEventListener('load', () => {
            jsWindow.initscene(fileName);
          });
        }
      })
      fileListElement.after(submitButton);
      setInterval(getFileList, 1000);
    </script>
  </body>
</html>
